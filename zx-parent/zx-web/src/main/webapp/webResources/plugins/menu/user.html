<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>用户管理</title>

<link rel="stylesheet"
	href="../font-awesome-4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="../jquery-easyui-1.5.3/themes/default/easyui.css">
<link rel="stylesheet" type="text/css" href="../jquery-easyui-1.5.3/themes/icon.css">
<link rel="stylesheet" href="../layui/css/layui.css">
<link rel="stylesheet" href="dist/right-content.css">

<style type="text/css">
	.container{
		width:90%;
		margin: auto;
	}
	.query-panel{
		border: 1px solid #D9D9D9;
		padding:8px 12px 0px;
		background: #FCFCFC;
	}
</style>
</head>
<body>
	<div class="container">
		<div class="layui-row query-panel">
		</div>
		<div class="layui-row">
			<table id="dataTb"></table>
		</div>
	</div>

	<script src="js/jquery-2.1.1.min.js" type="text/javascript"></script>
	<script src="../jquery-easyui-1.5.3/jquery.easyui.min.js" type="text/javascript"></script>
	<script src="../layui/layui.all.js" type="text/javascript"></script>
	<script>
	
	Date.prototype.format = function (format) {  
	    var o = {  
	        "M+": this.getMonth() + 1, // month  
	        "d+": this.getDate(), // day  
	        "h+": this.getHours(), // hour  
	        "m+": this.getMinutes(), // minute  
	        "s+": this.getSeconds(), // second  
	        "q+": Math.floor((this.getMonth() + 3) / 3), // quarter  
	        "S": this.getMilliseconds()  
	        // millisecond  
	    }  
	    if (/(y+)/.test(format))  
	        format = format.replace(RegExp.$1, (this.getFullYear() + "")  
	            .substr(4 - RegExp.$1.length));  
	    for (var k in o)  
	        if (new RegExp("(" + k + ")").test(format))  
	            format = format.replace(RegExp.$1, RegExp.$1.length == 1 ? o[k] : ("00" + o[k]).substr(("" + o[k]).length));  
	    return format;  
	}  
	function formatDatebox(value) {  
	    if (value == null || value == '') {  
	        return '';  
	    }  
	    var dt;  
	    if (value instanceof Date) {  
	        dt = value;  
	    } else {  
	        dt = new Date(value);  
	    }  
	  
	    return dt.format("yyyy-MM-dd hh:mm:ss"); //扩展的Date的format方法(上述插件实现)  
	}  
	
	
		//
		var dgPageNumber=1;//初始默认值
		var dgPageSize=10;//初始默认值
		$("#dataTb").datagrid({
			width: 'auto',  
            height:300,               
            striped: true,  
            singleSelect : true,  
            url:'/zx-web/sys/user/list',  
            queryParams:{loginname:''},  
            loadMsg:'数据加载中请稍后哈……',  
            pagination: true,  
            rownumbers: true,     
            columns:[[  
                {field:'id',title: 'ID',align: 'center',width: 80},  
                {field:'loginname',title: '登录名',align: 'center',width: 80},  
                {field:'username',title: '用户名',align: 'center',width: 80},  
                {field:'phone',title: '手机号',align: 'center',width: 100},  
                {field:'email',title: '邮箱',align: 'center',width: 120},  
                {field:'lastloginTime',title: '上次成功登录时间',align: 'center',width: 120,
                	formatter:formatDatebox},  
                {field:'locked',title: '是否锁定',align: 'center',width: 80},  
            ]],
            toolbar: [{  
                text: '添加',  
                iconCls: 'icon-add',  
                handler: function() {  
                    layer.alert("add");  
                }  
            }, '-', {  
                text: '修改',  
                iconCls: 'icon-edit',  
                handler: function() {  
                	layer.alert("edit");  
                }  
            }, '-',{  
                text: '删除',  
                iconCls: 'icon-remove',  
                handler: function(){  
                	layer.alert('remove');  
                }  
            }],
            pageNumber:dgPageNumber,
            pageSize:dgPageSize,
            onLoadSuccess:function(data){
                $("#dataTb").datagrid('getPager').pagination({
                    onRefresh:function(pageNumber,pageSize){
                        dgPageNumber=pageNumber;
                        dgPageSize=pageSize;
                        $("#dataTb").datagrid({
                            pageNumber:pageNumber,
                            pageSize:pageSize
                        });
                        //页码刷新后，数据要刷新，重新根据新页码查询数据
                        //loadData()
                    },
                    onChangePageSize:function(pageSize){
                        dgPageSize=pageSize;
                        $("#dataTb").datagrid({
                            pageNumber:dgPageNumber,
                            pageSize:pageSize
                        });
                        //页面承载条数改变，数据也要刷新
                        //loadData()
                    },
                    onSelectPage:function(pageNumber,pageSize){
                        dgPageNumber=pageNumber;
                        dgPageSize=pageSize;
                        $("#dataTb").datagrid({
                            pageNumber:pageNumber,
                            pageSize:pageSize
                        });
                        //页码改变，数据也要刷新
                        //loadData()
                    }
                })
            }
		});
	</script>
</body>
</html>